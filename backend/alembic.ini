# ======================================================================
# ğŸ§  ALEMBIC CONFIGURATION FILE
# ======================================================================
# Ce fichier configure Alembic, lâ€™outil de migration SQLAlchemy.
# Il permet de gÃ©rer les migrations de schÃ©ma de base de donnÃ©es
# (ajout de tables, colonnes, contraintes, etc.)
# ======================================================================


# ----------------------------------------------------------------------
# [alembic] â€” section principale
# ----------------------------------------------------------------------
[alembic]

# ğŸ“ Chemin vers le dossier des scripts de migration.
# Par dÃ©faut, Alembic crÃ©e un dossier "migrations" ou "alembic" Ã  la racine.
# "%(here)s" dÃ©signe le dossier oÃ¹ se trouve ce fichier ini.
script_location = %(here)s/migrations


# ğŸ”— URL de connexion Ã  la base (PostgreSQL, SQLite, etc.)
# â—ï¸Laisse cette ligne VIDE car on la dÃ©finit dynamiquement
# depuis "migrations/env.py" via une variable d'environnement (.env)
# Exemple dans env.py : config.set_main_option("sqlalchemy.url", os.getenv("ALEMBIC_DATABASE_URL"))
sqlalchemy.url =


# ğŸ§© ModÃ¨le de nommage des fichiers de migration (facultatif)
# Par dÃ©faut : "rev-slug" (ex: 1234_add_user_table.py)
# Tu peux activer le format "horodatÃ©" (date + heure) :
# file_template = %%(year)d_%%(month).2d_%%(day).2d-%%(rev)s_%%(slug)s


# ğŸ•’ Fuseau horaire utilisÃ© dans les noms de fichiers (optionnel)
# timezone = Europe/Paris


# ğŸ” SÃ©parateur de chemin (ne pas modifier)
# UtilisÃ© si tu as plusieurs rÃ©pertoires de versions.
path_separator = os


# ----------------------------------------------------------------------
# [post_write_hooks] â€” outils automatiques sur les fichiers de migration
# ----------------------------------------------------------------------
[post_write_hooks]
# Tu peux exÃ©cuter des outils comme "black" ou "ruff" aprÃ¨s chaque migration.
# Exemples :
# hooks = black
# black.type = console_scripts
# black.entrypoint = black
# black.options = -l 88 REVISION_SCRIPT_FILENAME


# ----------------------------------------------------------------------
# [loggers], [handlers], [formatters] â€” gestion des logs Alembic
# ----------------------------------------------------------------------

[loggers]
# Liste des loggers actifs.
keys = root,sqlalchemy,alembic

[handlers]
# DÃ©finit les types de gestionnaires de logs (ici, sortie console)
keys = console

[formatters]
# Liste des formatters (mise en forme du texte de log)
keys = generic


# --- Logger principal ---
[logger_root]
level = WARNING
handlers = console
qualname =

# --- Logger SQLAlchemy (affiche les requÃªtes SQL) ---
# Change "level" en INFO pour dÃ©boguer les requÃªtes SQL gÃ©nÃ©rÃ©es
[logger_sqlalchemy]
level = WARNING
handlers =
qualname = sqlalchemy.engine

# --- Logger Alembic (migrations) ---
[logger_alembic]
level = INFO
handlers =
qualname = alembic


# --- Handler console ---
[handler_console]
class = StreamHandler
args = (sys.stderr,)
level = NOTSET
formatter = generic


# --- Format des logs ---
[formatter_generic]
# Format du message affichÃ© dans le terminal
format = %(levelname)-5.5s [%(name)s] %(message)s
datefmt = %H:%M:%S


# ======================================================================
# ğŸ’¡ NOTES PRATIQUES
# ======================================================================
# ğŸ”¹ Ce fichier est lu automatiquement par Alembic (commande : alembic upgrade head)
# ğŸ”¹ Il ne doit PAS contenir de mot de passe en dur.
# ğŸ”¹ Lâ€™URL rÃ©elle de connexion (Neon, Supabase, Render, etc.)
#    doit Ãªtre dans ton fichier .env sous la clÃ© ALEMBIC_DATABASE_URL :
#
#    ALEMBIC_DATABASE_URL=postgresql+psycopg2://USER:PASSWORD@HOST_DIRECT:5432/DBNAME?sslmode=require
#
# ğŸ”¹ Ton fichier migrations/env.py injecte cette URL dans la config Alembic :
#    config.set_main_option("sqlalchemy.url", os.getenv("ALEMBIC_DATABASE_URL"))
#
# ğŸ”¹ Pour lancer les migrations :
#    $ alembic upgrade head
#
# ğŸ”¹ Pour crÃ©er une nouvelle migration :
#    $ alembic revision --autogenerate -m "Ajout table machines"
#
# ğŸ”¹ Les scripts seront crÃ©Ã©s dans :
#    migrations/versions/
#
# ğŸ”¹ Pour lister les migrations :
#    $ alembic history
# ======================================================================
