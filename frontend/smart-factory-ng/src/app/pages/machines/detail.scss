/* ========== Machine Detail ========== */

.machine-detail {
  display: grid;
  gap: 16px;

  /* Header (nom + badge état) */
  .bar {
    display: flex;
    align-items: center;
    gap: 8px;

    h2 {
      margin: 0;
      font-weight: 800;
      color: var(--sf-text);
    }

    /* badge état local (compatible avec [class.running|stopped|setup]) */
    .badge {
      margin-left: .25rem;
      padding: .25rem .6rem;
      border-radius: 999px;
      font-size: .75rem;
      font-weight: 700;
      text-transform: capitalize;
      border: 1px solid var(--sf-border);
      background: #fff;
      color: var(--sf-text-2);

      &.running {
        background: rgba(29, 185, 84, .12);
        color: #0f7a3a;
      }

      &.stopped {
        background: rgba(224, 49, 49, .14);
        color: #8f1e1e;
      }

      &.setup {
        background: rgba(255, 176, 32, .18);
        color: #925d00;
      }
    }
  }

  /* Meta (code, cadence…) */
  .meta {
    @extend .card;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 12px;
    padding: 12px;

    >div {
      background: var(--sf-bg);
      border: 1px dashed var(--sf-border);
      border-radius: 12px;
      padding: 10px 12px;
      color: var(--sf-text);

      strong {
        color: var(--sf-muted);
        margin-right: 6px;
        font-weight: 700;
      }
    }
  }

  /* KPIs (journée + global) */
  .kpis {
    display: grid;
    grid-template-columns: 1fr;
    gap: 16px;

    @media (min-width: 768px) {
      grid-template-columns: 1fr 1fr;
    }

    .card {
      @extend .card;

      .card-header {
        @extend .card-header;
        padding: 10px 14px;
        font-weight: 800;
      }

      .card-body {
        padding: 14px;

        .display-6 {
          font-size: clamp(1.5rem, 2.2vw, 2rem);
          line-height: 1.1;
        }

        .text-muted {
          color: var(--sf-muted) !important;
        }

        .text-danger {
          color: var(--sf-red) !important;
        }

        .text-succes {
          color: var(--sf-green) !important;
        }

        .d-flex {
          align-items: baseline;
        }
      }
    }
  }

  /* Événements récents — version FLEX (date + OF collés) */
  .events {
    @extend .card;

    h3 {
      margin: 0;
      padding: 10px 14px;
      border-bottom: 1px solid var(--sf-border);
      font-size: 1.05rem;
      font-weight: 800;
      color: var(--sf-text);
      background: linear-gradient(180deg, #fff, #fafbfc);
    }

    .list {
      list-style: none;
      margin: 0;
      padding: 0;

      li {
        display: flex;
        /* ✅ flex au lieu de grid */
        align-items: center;
        gap: 8px;
        /* espace régulier entre éléments */
        padding: 10px 14px;
        border-bottom: 1px solid var(--sf-border);
        flex-wrap: wrap;
        /* pile correctement sur mobile */

        &:last-child {
          border-bottom: 0;
        }

        /* Regroupement à gauche: dot, type, qty
           Centre: rien
           Droite: on laisse pousser les notes si besoin
        */
      }
    }

    .dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      display: inline-block;
      box-shadow: inset 0 0 0 2px rgba(0, 0, 0, .05);

      &.good {
        background: var(--sf-green);
      }

      &.scrap {
        background: var(--sf-red);
      }

      &.stop {
        background: var(--sf-amber);
      }
    }

    .type {
      font-weight: 700;
      text-transform: capitalize;
      color: var(--sf-text);
      padding-right: .25rem;
    }

    .qty {
      font-weight: 800;
      font-variant-numeric: tabular-nums;
      color: var(--sf-text);
    }

    .at {
      color: var(--sf-muted);
      font-size: .875rem;
      white-space: nowrap;
    }

    .wo {
      color: var(--sf-text-2);
      font-size: .85rem;
      background: var(--sf-bg);
      border: 1px solid var(--sf-border);
      padding: .15rem .5rem;
      border-radius: 999px;
      margin-left: 4px;
      /* ✅ juste après la date */
      white-space: nowrap;
    }

    /* pousse les notes en fin de ligne si besoin */
    .notes {
      color: var(--sf-text);
      opacity: .85;
      font-size: .95rem;
      margin-left: auto;
      /* ✅ envoie les notes à droite */
      /* Sur mobile, laisse wrap par dessous grâce à flex-wrap */
    }

    /* Amélioration responsive: sur petits écrans,
       force le retour à la ligne après date/OF pour éviter la collision */
    @media (max-width: 520px) {
      .notes {
        flex-basis: 100%;
        margin-left: 0;
        margin-top: 4px;
      }
    }
  }
}

/* Utilitaires page */
.muted {
  color: var(--sf-muted);
}

.error {
  color: var(--sf-red);
  background: color-mix(in srgb, var(--sf-red) 8%, transparent);
  border: 1px solid color-mix(in srgb, var(--sf-red) 24%, transparent);
  padding: 8px 12px;
  border-radius: 12px;
}
